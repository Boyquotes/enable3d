!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("THREE")):"function"==typeof define&&define.amd?define(["THREE"],e):"object"==typeof exports?exports.ENABLE3D=e(require("THREE")):t.ENABLE3D=e(t.THREE)}(window,(function(t){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=17)}([function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){console.error("%c [enable3d] "+t+" ","background: #222; color: #bada55")}},function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,r="~";function i(){}function s(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,o||t,i),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)o.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,i,s){var a=r?r+t:t;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,o),!0;case 5:return l.fn.call(l.context,e,n,o,i),!0;case 6:return l.fn.call(l.context,e,n,o,i,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var m,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,n);break;case 4:l[u].fn.call(l[u].context,e,n,o);break;default:if(!c)for(m=1,c=new Array(d-1);m<d;m++)c[m-1]=arguments[m];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},u.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},u.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||c(this,i);else{for(var a=0,u=[],l=s.length;a<l;a++)(s[a].fn!==e||o&&!s[a].once||n&&s[a].context!==n)&&u.push(s[a]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&c(this,e)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},function(t,e,n){"use strict";
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=i(n(1)),c=function(t){function e(){var e=t.call(this)||this;return e.vector3=new s.Vector3,e.hasBody=!1,e.anims={},e.currentAnimation="",e.name="object-"+e.id,e}return r(e,t),Object.defineProperty(e.prototype,"world",{get:function(){return{theta:this.worldTheta,phi:this.worldPhi}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldTheta",{get:function(){return this.getWorldDirection(this.vector3),Math.atan2(this.vector3.x,this.vector3.z)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldPhi",{get:function(){return this.getWorldDirection(this.vector3),Math.acos(this.vector3.y)},enumerable:!0,configurable:!0}),e.prototype.setAction=function(t){var e;if(this.mixer&&this.anims.hasOwnProperty(t)){var n=null===(e=this.mixer)||void 0===e?void 0:e.clipAction(this.anims[t]);n.time=0,this.mixer.stopAllAction(),n.fadeIn(.5),n.play(),this.currentAnimation=t}else a.default("[Phaser3D] Can't set animation "+t)},e}(s.Object3D);e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){function t(){this._defaultMaterial=new o.MeshLambertMaterial({color:13421772})}return t.prototype.get=function(){return this._defaultMaterial},t}();e.default=r},function(t,e,n){"use strict";
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=i(n(1)),c=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.vector3=new s.Vector3,o.hasBody=!1,o.anims={},o.currentAnimation="",o.name="object-"+o.id,o}return r(e,t),Object.defineProperty(e.prototype,"world",{get:function(){return{theta:this.worldTheta,phi:this.worldPhi}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldTheta",{get:function(){return this.getWorldDirection(this.vector3),Math.atan2(this.vector3.x,this.vector3.z)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldPhi",{get:function(){return this.getWorldDirection(this.vector3),Math.acos(this.vector3.y)},enumerable:!0,configurable:!0}),e.prototype.setAction=function(t){var e;if(this.mixer&&this.anims.hasOwnProperty(t)){var n=null===(e=this.mixer)||void 0===e?void 0:e.clipAction(this.anims[t]);n.time=0,this.mixer.stopAllAction(),n.fadeIn(.5),n.play(),this.currentAnimation=t}else a.default("[Phaser3D] Can't set animation "+t)},e}(s.Mesh);e.default=c},function(t,e,n){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(12));e.PhysicsLoader=function(t,e){window.__loadPhysics=!0,r.default(t,(function(){Ammo().then((function(){e()}))}))}},function(t,e,n){"use strict";
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(3));e.ExtendedObject3D=r.default;var i=o(n(5));e.ExtendedMesh=i.default;var s=n(0);e.AnimationMixer=s.AnimationMixer,e.AnimationClip=s.AnimationClip,e.AnimationAction=s.AnimationAction,e.Object3D=s.Object3D,e.Mesh=s.Mesh,e.Material=s.Material,e.Line=s.Line,e.Points=s.Points,e.Group=s.Group},function(t,e,n){"use strict";(function(t){
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */
var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});
/**
 * @author       Alex Bennett (https://github.com/timetocode)
 * @copyright    Copyright (c) 2014 Alex Bennett; Project Url: https://github.com/timetocode/node-game-loop
 * @license      {@link https://github.com/timetocode/node-game-loop/blob/master/LICENSE|MIT}
 */
var i=function(e){function n(t,n){void 0===t&&(t=60),void 0===n&&(n=!0);var o=e.call(this)||this;return o.tickLengthMs=1e3/60,o.previousTick=Date.now(),o.actualTicks=0,o._delta=0,o._isRunning=!1,n&&o.start(t),o}return r(n,e),n.prototype.start=function(t){void 0===t&&(t=60),this.tickLengthMs=1e3/t,this._isRunning=!0,this.startTime=Date.now(),this.loop()},n.prototype.stop=function(){this._isRunning=!1},n.prototype.isRunning=function(){return this._isRunning},n.prototype.getDelta=function(){return this._delta},n.prototype.getElapsedTime=function(){return Date.now()-this.startTime},n.prototype.onTick=function(t){var e=this;return this.on("tick",(function(){return t(e._delta)}))},n.prototype.loop=function(){var e=this;if(this._isRunning){var n=Date.now();this.actualTicks++,this.previousTick+this.tickLengthMs<=n&&(this._delta=(n-this.previousTick)/1e3,this.previousTick=n,this.emit("tick",this._delta),this.actualTicks=0),Date.now()-this.previousTick<this.tickLengthMs-16?setTimeout((function(){return e.loop()})):t((function(){return e.loop()}))}},n}(n(16));e.ServerClock=i}).call(this,n(13).setImmediate)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(n){Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))}))}))}},function(t,e,n){"use strict";
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=this&&this.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=i(n(5)),c=i(n(1)),u=i(n(4)),l=function(){function t(t){this.scene=t,this.isHeadless="headless"===t,this.defaultMaterial=new u.default}return Object.defineProperty(t.prototype,"make",{get:function(){var t=this;return{plane:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makePlane(e,n)},box:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makeBox(e,n)},sphere:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makeSphere(e,n)},cylinder:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makeCylinder(e,n)},cone:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makeCone(e,n)},torus:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.makeTorus(e,n)},extrude:function(e,n){return void 0===n&&(n={}),t.makeExtrude(e,n)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"add",{get:function(){var t=this;return{mesh:function(e){return t.addMesh(e)},existing:function(e){return t.addExisting(e)},plane:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addPlane(e,n)},box:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addBox(e,n)},ground:function(e,n){return void 0===n&&(n={}),t.addGround(e,n)},sphere:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addSphere(e,n)},cylinder:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addCylinder(e,n)},cone:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addCone(e,n)},torus:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addTorus(e,n)},extrude:function(e,n){return void 0===n&&(n={}),t.addExtrude(e,n)},material:function(e){return void 0===e&&(e={}),t.addMaterial(e)}}},enumerable:!0,configurable:!0}),t.prototype.addExisting=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];"headless"!==this.scene&&(t=this.scene).add.apply(t,e)},t.prototype.addMesh=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.addExisting(t[e]);else this.addExisting(t);return this},t.prototype.createMesh=function(t,e,n){var o,r=n.x,i=void 0===r?0:r,c=n.y,u=void 0===c?0:c,l=n.z,d=void 0===l?0:l;switch(!Array.isArray(e)&&e.type){case"LineBasicMaterial":o=new s.Line(t,e);break;case"PointsMaterial":o=new s.Points(t,e);break;default:o=new a.default(t,e)}return o.position.set(i,u,d),o.castShadow=o.receiveShadow=!0,o},t.prototype.makeExtrude=function(t,e){var n=t.x,i=t.y,a=t.z,c=t.name,u=t.shape,l=t.autoCenter,d=void 0===l||l,m=t.breakable,h=void 0!==m&&m,p=t.bufferGeometry,f=void 0===p||p,y=r(t,["x","y","z","name","shape","autoCenter","breakable","bufferGeometry"]),v=y.depth,b=void 0===v?1:v,g=y.bevelEnabled,w=void 0!==g&&g,x=f||h||this.isHeadless?new s.ExtrudeBufferGeometry(u,o({depth:b,bevelEnabled:w},y)):new s.ExtrudeGeometry(u,o({depth:b,bevelEnabled:w},y)),_=this.addMaterial(e),A=this.createMesh(x,_,{x:n,y:i,z:a});return d&&A.geometry.center(),A.name=c||"body_id_"+A.id,A.shape="extrude",A},t.prototype.addExtrude=function(t,e){void 0===e&&(e={});var n=this.makeExtrude(t,e);return this.addExisting(n),n},t.prototype.makePlane=function(t,e){var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=d||u||this.isHeadless?new s.PlaneBufferGeometry(m.width||1,m.height||1,m.widthSegments||1,m.heightSegments||1):new s.PlaneGeometry(m.width||1,m.height||1,m.widthSegments||1,m.heightSegments||1),p=this.addMaterial(e);p.side=s.DoubleSide;var f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="plane",f},t.prototype.addPlane=function(t,e){var n=this.makePlane(t,e);return this.addExisting(n),n},t.prototype.makeSphere=function(t,e){var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=d||u||this.isHeadless?new s.SphereBufferGeometry(m.radius||1,m.widthSegments||16,m.heightSegments||12,m.phiStart||void 0,m.phiLength||void 0,m.thetaStart||void 0,m.thetaLength||void 0):new s.SphereGeometry(m.radius||1,m.widthSegments||16,m.heightSegments||12,m.phiStart||void 0,m.phiLength||void 0,m.thetaStart||void 0,m.thetaLength||void 0),p=this.addMaterial(e),f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="sphere",f},t.prototype.addSphere=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.makeSphere(t,e);return this.addExisting(n),n},t.prototype.makeBox=function(t,e){var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=d||u||this.isHeadless?new s.BoxBufferGeometry(m.width||1,m.height||1,m.depth||1,m.widthSegments||void 0,m.heightSegments||void 0,m.depthSegments||void 0):new s.BoxGeometry(m.width||1,m.height||1,m.depth||1,m.widthSegments||void 0,m.heightSegments||void 0,m.depthSegments||void 0),p=this.addMaterial(e),f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="box",f},t.prototype.addBox=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.makeBox(t,e);return this.addExisting(n),n},t.prototype.addGround=function(t,e){void 0===e&&(e={});var n=this.makeBox(t,e);return n.rotateX(s.MathUtils.degToRad(90)),this.addExisting(n),n},t.prototype.makeCylinder=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=d||u||this.isHeadless?new s.CylinderBufferGeometry(m.radiusTop||1,m.radiusBottom||1,m.height||1,m.radiusSegments||void 0,m.heightSegments||void 0,m.openEnded||void 0,m.thetaStart||void 0,m.thetaLength||void 0):new s.CylinderGeometry(m.radiusTop||1,m.radiusBottom||1,m.height||1,m.radiusSegments||void 0,m.heightSegments||void 0,m.openEnded||void 0,m.thetaStart||void 0,m.thetaLength||void 0),p=this.addMaterial(e),f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="cylinder",f},t.prototype.addCylinder=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.makeCylinder(t,e);return this.addExisting(n),n},t.prototype.makeCone=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=(d||u||this.isHeadless,new s.ConeBufferGeometry(m.radius||1,m.height||1,m.radiusSegments||8,m.heightSegments||1,m.openEnded||!1,m.thetaStart||0,m.thetaLength||2*Math.PI)),p=this.addMaterial(e),f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="cone",f},t.prototype.addCone=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.makeCone(t,e);return this.addExisting(n),n},t.prototype.makeTorus=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=t.x,o=t.y,i=t.z,a=t.name,c=t.breakable,u=void 0!==c&&c,l=t.bufferGeometry,d=void 0===l||l,m=r(t,["x","y","z","name","breakable","bufferGeometry"]),h=d||u||this.isHeadless?new s.TorusBufferGeometry(m.radius||void 0,m.tube||void 0,m.radialSegments||void 0,m.tubularSegments||void 0,m.arc||void 0):new s.TorusGeometry(m.radius||void 0,m.tube||void 0,m.radialSegments||void 0,m.tubularSegments||void 0,m.arc||void 0),p=this.addMaterial(e),f=this.createMesh(h,p,{x:n,y:o,z:i});return f.name=a||"body_id_"+f.id,f.shape="torus",f},t.prototype.addTorus=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.makeTorus(t,e);return this.addExisting(n),n},t.prototype.addMaterial=function(t){void 0===t&&(t={});var e,n=Object.keys(t)[0];if("headless"===this.scene)return this.defaultMaterial.get();switch(n){case"basic":e=new s.MeshBasicMaterial(t.basic);break;case"normal":e=new s.MeshNormalMaterial(t.normal);break;case"standard":e=new s.MeshStandardMaterial(t.standard);break;case"lambert":e=new s.MeshLambertMaterial(t.lambert);break;case"phong":e=new s.MeshPhongMaterial(t.phong);break;case"physical":void 0!==t.physical?e=new s.MeshPhysicalMaterial(t.physical):(c.default("You need to pass parameters to the physical material. (Fallback to default material)"),e=this.defaultMaterial.get());break;case"toon":e=new s.MeshToonMaterial(t.toon);break;case"line":e=new s.LineBasicMaterial(t.line);break;case"points":e=new s.PointsMaterial(t.points);break;case"custom":e=t.custom||this.defaultMaterial.get();break;default:e=this.defaultMaterial.get()}return e},t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(t){}return!1}(),r=function(t,e){var n=document.createElement("script");n.onload=function(){e()},n.onerror=function(){throw new Error("failed to load "+t)},n.async=!0,n.src=t,document.head.appendChild(n)};e.default=function(t,e){r(o?t+"/ammo.wasm.js":t+"/ammo.js",(function(){return e()}))}},function(t,e,n){(function(t){var o=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(r.call(setTimeout,o,arguments),clearTimeout)},e.setInterval=function(){return new i(r.call(setInterval,o,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(o,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(14),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(9))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var o,r,i,s,a,c=1,u={},l=!1,d=t.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(t);m=m&&m.setTimeout?m:t,"[object process]"==={}.toString.call(t.process)?o=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){p(t.data)},o=function(t){i.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(r=d.documentElement,o=function(t){var e=d.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):o=function(t){setTimeout(p,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&p(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),o=function(e){t.postMessage(s+e,"*")}),m.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return u[c]=r,o(c),c++},m.clearImmediate=h}function h(t){delete u[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=u[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{h(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(9),n(15))},function(t,e){var n,o,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(t){o=s}}();var c,u=[],l=!1,d=-1;function m(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!l){var t=a(m);l=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||l||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";var o,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};o=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function d(t,e,n,o){var r,i,s,a;if(u(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),(r=l(t))>0&&s.length>r&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var o={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=m.bind(o);return r.listener=n,o.wrapFn=r,r}function p(t,e,n){var o=t._events;if(void 0===o)return[];var r=o[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):y(r,r.length)}function f(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),o=0;o<e;++o)n[o]=t[o];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var o="error"===t,r=this._events;if(void 0!==r)o=o&&void 0===r.error;else if(!o)return!1;if(o){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=r[t];if(void 0===c)return!1;if("function"==typeof c)i(c,this,e);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},a.prototype.addListener=function(t,e){return d(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return d(this,t,e,!0)},a.prototype.once=function(t,e){return u(e),this.on(t,h(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,h(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,o,r,i,s;if(u(e),void 0===(o=this._events))return this;if(void 0===(n=o[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,r=i;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(o[t]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,i=Object.keys(n);for(o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(t,e,n){"use strict";n.r(e);var o,r,i=n(1),s=n.n(i),a=n(2),c=n.n(a),u=n(0),l=function(){function t(t,e){this.physics=t,this.ammo=e,this.offset={x:0,y:0,z:0},this.errors=[],this.checkCollisions=!1,this.breakable=!1,this.collided=!1,this.didUpdate=!1,this._emitUpdateEvents=!1,this._needUpdate=!1,this.tmpEuler=new u.Euler,this.tmpQuaternion=new u.Quaternion,this.tmpBtVector3=new Ammo.btVector3,this.tmpBtQuaternion=new Ammo.btQuaternion(0,0,0,1),this.name=e.name}return t.prototype.setupEventEmitter=function(){void 0===this.eventEmitter&&(this.eventEmitter=new c.a)},Object.defineProperty(t.prototype,"needUpdate",{get:function(){return this._needUpdate},set:function(t){!t&&this._needUpdate&&(this.didUpdate=!0),this._needUpdate=t},enumerable:!0,configurable:!0}),t.prototype.onUpdateEvent=function(t,e){void 0===e&&(e=!1),this.setupEventEmitter(),this._emitUpdateEvents=!0,e?this.eventEmitter.once("update",(function(){t()})):this.eventEmitter.on("update",(function(){t()}))},Object.defineProperty(t.prototype,"on",{get:function(){var t=this;return{update:function(e){return t.onUpdateEvent(e)},collision:function(e){return t.onCollision(e)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"once",{get:function(){var t=this;return{update:function(e){return t.onUpdateEvent(e,!0)}}},enumerable:!0,configurable:!0}),t.prototype.onCollision=function(t){var e=this;this.checkCollisions=!0,this.physics.on("collision",(function(n){var o=n.bodies,r=n.event;o[0].name===e.name?t(o[1],r):o[1].name===e.name&&t(o[0],r)}))},t.prototype.transform=function(){var t=this.physics.tmpTrans;this.ammo.getMotionState().getWorldTransform(t)},t.prototype.refresh=function(){var t=this.physics.tmpTrans;this.ammo.getMotionState().setWorldTransform(t)},t.prototype.setRotation=function(t,e,n){var o=this.tmpEuler.set(t,e,n),r=this.tmpQuaternion.set(0,0,0,1);r.setFromEuler(o),this.tmpBtQuaternion.setValue(0,0,0,1);var i=this.tmpBtQuaternion;i.setValue(r.x,r.y,r.z,r.w),this.physics.tmpTrans.setRotation(i)},Object.defineProperty(t.prototype,"rotation",{get:function(){var t=this.physics.tmpTrans.getRotation(),e=this.tmpQuaternion.set(t.x(),t.y(),t.z(),t.w()),n=e.x,o=e.y,r=e.z,i=e.w,s=2*Math.acos(i);return{x:n/Math.sqrt(1-i*i)*s||0,y:o/Math.sqrt(1-i*i)*s||0,z:r/Math.sqrt(1-i*i)*s||0}},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,e,n){this.physics.tmpTrans.getOrigin().setValue(t,e,n)},Object.defineProperty(t.prototype,"position",{get:function(){var t=this.physics.tmpTrans;return{x:t.getOrigin().x(),y:t.getOrigin().y(),z:t.getOrigin().z()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"velocity",{get:function(){return{x:this.ammo.getLinearVelocity().x(),y:this.ammo.getLinearVelocity().y(),z:this.ammo.getLinearVelocity().z()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angularVelocity",{get:function(){return{x:this.ammo.getAngularVelocity().x(),y:this.ammo.getAngularVelocity().y(),z:this.ammo.getAngularVelocity().z()}},enumerable:!0,configurable:!0}),t.prototype.setVelocity=function(t,e,n){this.tmpBtVector3.setValue(t,e,n),this.ammo.setLinearVelocity(this.tmpBtVector3)},t.prototype.setVelocityX=function(t){this.tmpBtVector3.setValue(t,this.velocity.y,this.velocity.z),this.ammo.setLinearVelocity(this.tmpBtVector3)},t.prototype.setVelocityY=function(t){this.tmpBtVector3.setValue(this.velocity.x,t,this.velocity.z),this.ammo.setLinearVelocity(this.tmpBtVector3)},t.prototype.setVelocityZ=function(t){this.tmpBtVector3.setValue(this.velocity.x,this.velocity.y,t),this.ammo.setLinearVelocity(this.tmpBtVector3)},t.prototype.setAngularVelocity=function(t,e,n){this.tmpBtVector3.setValue(t,e,n),this.ammo.setAngularVelocity(this.tmpBtVector3)},t.prototype.setAngularVelocityX=function(t){this.tmpBtVector3.setValue(t,this.angularVelocity.y,this.angularVelocity.z),this.ammo.setAngularVelocity(this.tmpBtVector3)},t.prototype.setAngularVelocityY=function(t){this.tmpBtVector3.setValue(this.angularVelocity.x,t,this.angularVelocity.z),this.ammo.setAngularVelocity(this.tmpBtVector3)},t.prototype.setAngularVelocityZ=function(t){this.tmpBtVector3.setValue(this.angularVelocity.x,this.angularVelocity.y,t),this.ammo.setAngularVelocity(this.tmpBtVector3)},t.prototype.applyForce=function(t,e,n){this.tmpBtVector3.setValue(t,e,n),this.ammo.applyCentralImpulse(this.tmpBtVector3)},t.prototype.applyForceX=function(t){this.tmpBtVector3.setValue(t,0,0),this.ammo.applyCentralImpulse(this.tmpBtVector3)},t.prototype.applyForceY=function(t){this.tmpBtVector3.setValue(0,t,0),this.ammo.applyCentralImpulse(this.tmpBtVector3)},t.prototype.applyForceZ=function(t){this.tmpBtVector3.setValue(0,0,t),this.ammo.applyCentralImpulse(this.tmpBtVector3)},t.prototype.setCollisionFlags=function(t){this.ammo.setCollisionFlags(t)},t.prototype.getCollisionFlags=function(){return this.ammo.getCollisionFlags()},t.prototype.setRestitution=function(t){this.ammo.setRestitution(t)},t.prototype.setBounciness=function(t){this.setRestitution(t)},t.prototype.setFriction=function(t){this.ammo.setFriction(t)},t.prototype.setLinearFactor=function(t,e,n){this.tmpBtVector3.setValue(t,e,n),this.ammo.setLinearFactor(this.tmpBtVector3)},t.prototype.setAngularFactor=function(t,e,n){this.tmpBtVector3.setValue(t,e,n),this.ammo.setAngularFactor(this.tmpBtVector3)},t.prototype.setCcdMotionThreshold=function(t){this.ammo.setCcdMotionThreshold(t)},t.prototype.setCcdSweptSphereRadius=function(t){this.ammo.setCcdSweptSphereRadius(t)},t}(),d=n(10),m=n.n(d),h=function(){return(h=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},p=function(){function t(){this.objectsAmmo={}}return t.prototype.addPlane=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.plane(t,e);return this.addExisting(n,t),n},t.prototype.addSphere=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.sphere(t,e);return this.addExisting(n,t),n},t.prototype.addBox=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.box(t,e);return this.addExisting(n,t),n},t.prototype.addGround=function(t,e){void 0===e&&(e={});var n=this.factory.add.ground(t,e),o=h(h({},t),{mass:0,collisionFlags:1});return this.addExisting(n,o),n},t.prototype.addCylinder=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.cylinder(t,e);return this.addExisting(n,t),n},t.prototype.addCone=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.cone(t,e);return this.addExisting(n,t),n},t.prototype.addTorus=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=this.factory.add.torus(t,e);return this.addExisting(n,t),n},t.prototype.addExtrude=function(t,e){void 0===e&&(e={});var n=this.factory.add.extrude(t,e);return n.translateX(1),this.addExisting(n),n},t}(),f=function(){function t(){}return Object.defineProperty(t.prototype,"addConstraints",{get:function(){var t=this;return{lock:function(e,n){return t.lock(e,n)},fixed:function(e,n){return t.fixed(e,n)},spring:function(e,n,o){return t.spring(e,n,o)},slider:function(e,n){return t.slider(e,n)},hinge:function(e,n,o){return t.hinge(e,n,o)},coneTwist:function(e,n){return t.coneTwist(e,n)},pointToPoint:function(e,n,o){return t.pointToPoint(e,n,o)}}},enumerable:!0,configurable:!0}),t.prototype.getTransform=function(t,e){var n=t.getCenterOfMassTransform().inverse().op_mul(e.getWorldTransform()),o=new Ammo.btTransform;return o.setIdentity(),{body:n,target:o}},t.prototype.lock=function(t,e){var n=this.getTransform(t.ammo,e.ammo),o=new Ammo.btGeneric6DofConstraint(t.ammo,e.ammo,n.body,n.target,!0),r=new Ammo.btVector3(0,0,0);o.setLinearLowerLimit(r),o.setLinearUpperLimit(r),o.setAngularLowerLimit(r),o.setAngularUpperLimit(r),this.physicsWorld.addConstraint(o)},t.prototype.fixed=function(t,e){var n=this.getTransform(t.ammo,e.ammo);n.body.setRotation(t.ammo.getWorldTransform().getRotation()),n.target.setRotation(e.ammo.getWorldTransform().getRotation());var o=new Ammo.btFixedConstraint(t.ammo,e.ammo,n.body,n.target);this.physicsWorld.addConstraint(o)},t.prototype.spring=function(t,e,n){void 0===n&&(n={});var o=n.stiffness,r=void 0===o?50:o,i=n.damping,s=void 0===i?.01:i,a=n.angularLock,c=void 0!==a&&a,u=this.getTransform(t.ammo,e.ammo),l=new Ammo.btGeneric6DofSpringConstraint(t.ammo,e.ammo,u.body,u.target,!0);l.setLinearLowerLimit(new Ammo.btVector3(-100,-100,-100)),l.setLinearUpperLimit(new Ammo.btVector3(100,100,100)),c&&(l.setAngularLowerLimit(new Ammo.btVector3(0,0,0)),l.setAngularUpperLimit(new Ammo.btVector3(0,0,0)));for(var d=0;d<3;d++)l.enableSpring(d,!0),l.setStiffness(d,r),l.setDamping(d,s);this.physicsWorld.addConstraint(l)},t.prototype.slider=function(t,e){var n=this.getTransform(t.ammo,e.ammo),o=new Ammo.btSliderConstraint(t.ammo,e.ammo,n.body,n.target,!0);o.setLowerLinLimit(-1),o.setUpperLinLimit(1),this.physicsWorld.addConstraint(o)},t.prototype.hinge=function(t,e,n){void 0===n&&(n={});var o=n.pivot,r=n.targetPivot,i=n.axis,s=n.targetAxis,a=new Ammo.btVector3((null==o?void 0:o.x)||0,(null==o?void 0:o.y)||0,(null==o?void 0:o.z)||0),c=new Ammo.btVector3((null==r?void 0:r.x)||0,(null==r?void 0:r.y)||0,(null==r?void 0:r.z)||0),u=new Ammo.btVector3((null==i?void 0:i.x)||0,(null==i?void 0:i.y)||0,(null==i?void 0:i.z)||1),l=new Ammo.btVector3((null==s?void 0:s.x)||0,(null==s?void 0:s.y)||0,(null==s?void 0:s.z)||1),d=new Ammo.btHingeConstraint(t.ammo,e.ammo,a,c,u,l,!0);this.physicsWorld.addConstraint(d)},t.prototype.coneTwist=function(t,e){void 0===e&&(e={});var n=new Ammo.btTransform;n.setIdentity(),n.getOrigin().setValue((null==e?void 0:e.x)||0,(null==e?void 0:e.y)||0,(null==e?void 0:e.z)||0);var o=new Ammo.btConeTwistConstraint(t.ammo,n);this.physicsWorld.addConstraint(o)},t.prototype.pointToPoint=function(t,e,n){void 0===n&&(n={});var o=n.pivot,r=n.targetPivot,i=new Ammo.btVector3((null==o?void 0:o.x)||0,(null==o?void 0:o.y)||0,(null==o?void 0:o.z)||0),s=new Ammo.btVector3((null==r?void 0:r.x)||0,(null==r?void 0:r.y)||0,(null==r?void 0:r.z)||0),a=new Ammo.btPoint2PointConstraint(t.ammo,e.ammo,i,s);this.physicsWorld.addConstraint(a)},t}(),y=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.addCollider=function(t,e,n){t.body&&e.body&&(t.body.checkCollisions=!0,e.body.checkCollisions=!0,this.on("collision",(function(o){var r,i,s=o.bodies,a=o.event;(null===(r=s[0])||void 0===r?void 0:r.name)&&(null===(i=s[1])||void 0===i?void 0:i.name)&&(null==t?void 0:t.name)&&(null==e?void 0:e.name)&&(s[0].name===t.name&&s[1].name===e.name||s[1].name===t.name&&s[0].name===e.name)&&n(a)})))},e}(c.a),b=1,g=32768,w=function(){function t(t,e,n){void 0===n&&(n={}),this.scene=t,this.world=e,this.options=n,this.debugDrawMode=n.debugDrawMode||b;var o=this.debugDrawMode&g||!1,r=n.maxBufferSize||1e6;this.geometry=new u.BufferGeometry;var i=new Float32Array(3*r),s=new Float32Array(3*r);this.geometry.setAttribute("position",new u.BufferAttribute(i,3).setUsage(u.StaticDrawUsage)),this.geometry.setAttribute("color",new u.BufferAttribute(s,3).setUsage(u.StaticDrawUsage)),this.index=0;var a=new u.LineBasicMaterial({vertexColors:!0,depthTest:!o});this.mesh=new u.LineSegments(this.geometry,a),o&&(this.mesh.renderOrder=999),this.mesh.frustumCulled=!1,this.enabled=!1,this.debugDrawer=new Ammo.DebugDrawer,this.debugDrawer.drawLine=this.drawLine.bind(this),this.debugDrawer.drawContactPoint=this.drawContactPoint.bind(this),this.debugDrawer.reportErrorWarning=this.reportErrorWarning.bind(this),this.debugDrawer.draw3dText=this.draw3dText.bind(this),this.debugDrawer.setDebugMode=this.setDebugMode.bind(this),this.debugDrawer.getDebugMode=this.getDebugMode.bind(this),this.world.setDebugDrawer(this.debugDrawer)}return t.prototype.enable=function(){this.enabled=!0,this.scene.add(this.mesh)},t.prototype.disable=function(){this.enabled=!1,this.scene.remove(this.mesh)},t.prototype.update=function(){this.enabled&&(0!=this.index&&(this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.color.needsUpdate=!0),this.index=0,this.world.debugDrawWorld(),this.geometry.setDrawRange(0,this.index))},t.prototype.drawLine=function(t,e,n){var o=Ammo.HEAPF32,r=o[(n+0)/4],i=o[(n+4)/4],s=o[(n+8)/4],a=o[(t+0)/4],c=o[(t+4)/4],u=o[(t+8)/4];this.geometry.attributes.position.setXYZ(this.index,a,c,u),this.geometry.attributes.color.setXYZ(this.index++,r,i,s);var l=o[(e+0)/4],d=o[(e+4)/4],m=o[(e+8)/4];this.geometry.attributes.position.setXYZ(this.index,l,d,m),this.geometry.attributes.color.setXYZ(this.index++,r,i,s)},t.prototype.drawContactPoint=function(t,e,n,o,r){var i=Ammo.HEAPF32,s=i[(r+0)/4],a=i[(r+4)/4],c=i[(r+8)/4],u=i[(t+0)/4],l=i[(t+4)/4],d=i[(t+8)/4];this.geometry.attributes.position.setXYZ(this.index,u,l,d),this.geometry.attributes.color.setXYZ(this.index++,s,a,c);var m=i[(e+0)/4]*n,h=i[(e+4)/4]*n,p=i[(e+8)/4]*n;this.geometry.attributes.position.setXYZ(this.index,u+m,l+h,d+p),this.geometry.attributes.color.setXYZ(this.index++,s,a,c)},t.prototype.reportErrorWarning=function(t){Ammo.hasOwnProperty("Pointer_stringify")?console.warn(Ammo.Pointer_stringify(t)):this.warnedOnce||(this.warnedOnce=!0,console.warn("Cannot print warningString, please rebuild Ammo.js using 'debug' flag"))},t.prototype.draw3dText=function(t,e){console.warn("TODO: draw3dText")},t.prototype.setDebugMode=function(t){this.debugDrawMode=t},t.prototype.getDebugMode=function(){return this.debugDrawMode},t}(),x=function(t,e){this.minSizeForBreak=t||1.4,this.smallDelta=e||1e-4,this.tempLine1=new u.Line3,this.tempPlane1=new u.Plane,this.tempPlane2=new u.Plane,this.tempPlane_Cut=new u.Plane,this.tempCM1=new u.Vector3,this.tempCM2=new u.Vector3,this.tempVector3=new u.Vector3,this.tempVector3_2=new u.Vector3,this.tempVector3_3=new u.Vector3,this.tempVector3_P0=new u.Vector3,this.tempVector3_P1=new u.Vector3,this.tempVector3_P2=new u.Vector3,this.tempVector3_N0=new u.Vector3,this.tempVector3_N1=new u.Vector3,this.tempVector3_AB=new u.Vector3,this.tempVector3_CB=new u.Vector3,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var n=0;n<900;n++)this.segments[n]=!1};x.prototype={constructor:x,prepareBreakableObject:function(t,e,n,o,r){t.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var i=t.userData;i.mass=e,i.velocity=n.clone(),i.angularVelocity=o.clone(),i.breakable=r},subdivideByImpact:function(t,e,n,o,r){var i=[],s=this.tempPlane1,a=this.tempPlane2;this.tempVector3.addVectors(e,n),s.setFromCoplanarPoints(e,t.position,this.tempVector3);var c=r+o,u=this;return function r(l,d,m,h){if(Math.random()<.05*h||h>c)i.push(l);else{var p=Math.PI;0===h?(a.normal.copy(s.normal),a.constant=s.constant):h<=o?(p=(m-d)*(.2+.6*Math.random())+d,u.tempVector3_2.copy(t.position).sub(e).applyAxisAngle(n,p).add(e),a.setFromCoplanarPoints(e,u.tempVector3,u.tempVector3_2)):(p=(.5*(1&h)+.2*(2-Math.random()))*Math.PI,u.tempVector3_2.copy(e).sub(l.position).applyAxisAngle(n,p).add(l.position),u.tempVector3_3.copy(n).add(l.position),a.setFromCoplanarPoints(l.position,u.tempVector3_3,u.tempVector3_2)),u.cutByPlane(l,a,u.tempResultObjects);var f=u.tempResultObjects.object1,y=u.tempResultObjects.object2;f&&r(f,d,p,h+1),y&&r(y,p,m,h+1)}}(t,0,2*Math.PI,0),i},cutByPlane:function(t,e,n){var o=t.geometry,r=o.attributes.position.array,i=o.attributes.normal.array,a=r.length/3,c=a/3,l=o.getIndex();function d(t,e){var n=3*t+e;return l?l[n]:n}l&&(c=(l=l.array).length/3);for(var m=[],h=[],p=this.smallDelta,f=a*a,y=0;y<f;y++)this.segments[y]=!1;var v=this.tempVector3_P0,b=this.tempVector3_P1,g=this.tempVector3_N0,w=this.tempVector3_N1;for(y=0;y<c-1;y++){var _=d(y,0),A=d(y,1),V=d(y,2);g.set(i[_],i[_]+1,i[_]+2);for(var P=y+1;P<c;P++){var O=d(P,0),M=d(P,1),C=d(P,2);w.set(i[O],i[O]+1,i[O]+2),1-g.dot(w)<p&&(_===O||_===M||_===C?A===O||A===M||A===C?(this.segments[_*a+A]=!0,this.segments[A*a+_]=!0):(this.segments[V*a+_]=!0,this.segments[_*a+V]=!0):A!==O&&A!==M&&A!==C||(this.segments[V*a+A]=!0,this.segments[A*a+V]=!0))}}var T=this.tempPlane_Cut;t.updateMatrix(),x.transformPlaneToLocalSpace(e,t.matrix,T);for(y=0;y<c;y++)for(var E=d(y,0),S=d(y,1),j=d(y,2),k=0;k<3;k++){var B=0===k?E:1===k?S:j,D=0===k?S:1===k?j:E;if(!this.segments[B*a+D]){this.segments[B*a+D]=!0,this.segments[D*a+B]=!0,v.set(r[3*B],r[3*B+1],r[3*B+2]),b.set(r[3*D],r[3*D+1],r[3*D+2]);var L=0;(z=T.distanceToPoint(v))>p?(L=2,h.push(v.clone())):z<-p?(L=1,m.push(v.clone())):(L=3,m.push(v.clone()),h.push(v.clone()));var z,I=0;if((z=T.distanceToPoint(b))>p?(I=2,h.push(b.clone())):z<-p?(I=1,m.push(b.clone())):(I=3,m.push(b.clone()),h.push(b.clone())),1===L&&2===I||2===L&&1===I){this.tempLine1.start.copy(v),this.tempLine1.end.copy(b);var H=new u.Vector3;if(void 0===(H=T.intersectLine(this.tempLine1,H)))return console.error("Internal error: segment does not intersect plane."),n.segmentedObject1=null,n.segmentedObject2=null,0;m.push(H),h.push(H.clone())}}}var R=.5*t.userData.mass;this.tempCM1.set(0,0,0);var F=0,G=m.length;if(G>0){for(y=0;y<G;y++)this.tempCM1.add(m[y]);this.tempCM1.divideScalar(G);for(y=0;y<G;y++){(U=m[y]).sub(this.tempCM1),F=Math.max(F,U.x,U.y,U.z)}this.tempCM1.add(t.position)}this.tempCM2.set(0,0,0);var N=0,W=h.length;if(W>0){for(y=0;y<W;y++)this.tempCM2.add(h[y]);this.tempCM2.divideScalar(W);for(y=0;y<W;y++){var U;(U=h[y]).sub(this.tempCM2),N=Math.max(N,U.x,U.y,U.z)}this.tempCM2.add(t.position)}var Q=null,q=null,Y=0;if(G>4)try{(Q=new u.Mesh(new u.ConvexBufferGeometry(m),t.material)).position.copy(this.tempCM1),Q.quaternion.copy(t.quaternion),this.prepareBreakableObject(Q,R,t.userData.velocity,t.userData.angularVelocity,2*F>this.minSizeForBreak),Y++}catch(t){s()("Error in ConvexObjectBreaker.ts")}if(W>4)try{(q=new u.Mesh(new u.ConvexBufferGeometry(h),t.material)).position.copy(this.tempCM2),q.quaternion.copy(t.quaternion),this.prepareBreakableObject(q,R,t.userData.velocity,t.userData.angularVelocity,2*N>this.minSizeForBreak),Y++}catch(t){s()("Error in ConvexObjectBreaker.ts")}return n.object1=Q,n.object2=q,Y}},x.transformFreeVector=function(t,e){var n=t.x,o=t.y,r=t.z,i=e.elements;return t.x=i[0]*n+i[4]*o+i[8]*r,t.y=i[1]*n+i[5]*o+i[9]*r,t.z=i[2]*n+i[6]*o+i[10]*r,t},x.transformFreeVectorInverse=function(t,e){var n=t.x,o=t.y,r=t.z,i=e.elements;return t.x=i[0]*n+i[1]*o+i[2]*r,t.y=i[4]*n+i[5]*o+i[6]*r,t.z=i[8]*n+i[9]*o+i[10]*r,t},x.transformTiedVectorInverse=function(t,e){var n=t.x,o=t.y,r=t.z,i=e.elements;return t.x=i[0]*n+i[1]*o+i[2]*r-i[12],t.y=i[4]*n+i[5]*o+i[6]*r-i[13],t.z=i[8]*n+i[9]*o+i[10]*r-i[14],t},x.transformPlaneToLocalSpace=(r=new u.Vector3,function(t,e,n){n.normal.copy(t.normal),n.constant=t.constant;var o=x.transformTiedVectorInverse(t.coplanarPoint(r),e);x.transformFreeVectorInverse(n.normal,e),n.constant=-o.dot(n.normal)});
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */
var _=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),A=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o},V=function(t){function e(e,n){void 0===n&&(n={});var o=t.call(this)||this;return o.scene=e,o.config=n,o.rigidBodies=[],o.objectsAmmo={},o.earlierDetectedCollisions=[],o}return _(e,t),e.prototype.destroy=function(t){var e;if(void 0!==(null==t?void 0:t.ammo)){var n=Object.values(t.ammo)[0],o=Object.values(t.ammo)[1],r=this.objectsAmmo[n];if(n&&o&&r&&(null===(e=null==r?void 0:r.body)||void 0===e?void 0:e.ammo)){this.physicsWorld.removeRigidBody(r.body.ammo),r.body=void 0,r.hasBody=!1,delete this.objectsAmmo[n];for(var i=0;i<this.rigidBodies.length;i++)this.rigidBodies[i].name===o&&(this.rigidBodies.splice(i,1),i--)}}},e.prototype.setup=function(){if("headless"!==this.scene){this.convexBreaker=new x,this.objectsToRemove=[],this.numObjectsToRemove=0;for(var t=0;t<500;t++)this.objectsToRemove[t]=null}this.setupPhysicsWorld(),"headless"!==this.scene&&(this.debugDrawer=new w(this.scene,this.physicsWorld,{}))},e.prototype.updateDebugger=function(){"headless"!==this.scene&&this.debugDrawer&&this.debugDrawer.enabled&&this.debugDrawer.update()},e.prototype.setupPhysicsWorld=function(){var t=this.gravity,e=new Ammo.btDefaultCollisionConfiguration,n=new Ammo.btCollisionDispatcher(e),o=new Ammo.btDbvtBroadphase,r=new Ammo.btSequentialImpulseConstraintSolver;this.physicsWorld=new Ammo.btDiscreteDynamicsWorld(n,o,r,e),this.physicsWorld.setGravity(new Ammo.btVector3(t.x,t.y,t.z)),this.dispatcher=n,this.tmpTrans=new Ammo.btTransform},e.prototype.createDebrisFromBreakableObject=function(t,e){"headless"!==this.scene&&(t.material=this.defaultMaterial.get(),t.shape="hull",t.fragmentDepth=e.fragmentDepth+1,this.scene.add(t),this.addExisting(t),t.body.breakable=!1,setTimeout((function(){t.body.breakable=!0}),2500))},e.prototype.removeDebris=function(t){"headless"!==this.scene&&(this.scene.remove(t),this.physicsWorld.removeRigidBody(t.body.ammo),delete this.objectsAmmo[t.ptr])},e.prototype.update=function(t){var e,n,o=this;this.impactPoint.set(0,0,0),this.impactNormal.set(0,0,0);var r=[],i=t/1e3;if(this.physicsWorld.stepSimulation(i,this.config.maxSubSteps||1,this.config.fixedTimeStep||1/60),"headless"!==this.scene)for(var s=0,a=this.rigidBodies.length;s<a;s++){var c=this.rigidBodies[s],u=c.body.ammo.getMotionState();if(u){if(u.getWorldTransform(this.tmpTrans),c.body.didUpdate&&(c.body._emitUpdateEvents&&c.body.eventEmitter.emit("update"),c.body.didUpdate=!1),c.body.ammo.isKinematicObject()&&c.body.needUpdate)c.getWorldQuaternion(this.tmpQuaternion),c.getWorldPosition(this.tmpVector3),this.tmpBtVector3.setValue(this.tmpVector3.x,this.tmpVector3.y,this.tmpVector3.z),this.tmpBtQuaternion.setValue(this.tmpQuaternion.x,this.tmpQuaternion.y,this.tmpQuaternion.z,this.tmpQuaternion.w),this.tmpTrans.setOrigin(this.tmpBtVector3),this.tmpTrans.setRotation(this.tmpBtQuaternion),u.setWorldTransform(this.tmpTrans),c.body.needUpdate=!1;else{var l=this.tmpTrans.getOrigin(),d=this.tmpTrans.getRotation(),m=c.body.offset;c.position.set(l.x()+m.x,l.y()+m.y,l.z()+m.z),c.quaternion.set(d.x(),d.y(),d.z(),d.w())}c.body.collided=!1}}var h,p,f,y,v,b,g,w,x,_=function(){var t=V.dispatcher.getManifoldByIndexInternal(s),o=Object.keys(t.getBody0())[0],i=Ammo.castObject(t.getBody0(),Ammo.btRigidBody),a=Ammo.castObject(t.getBody1(),Ammo.btRigidBody);if(""===i.name&&""===a.name)return"continue";var c=i[o],u=a[o],l=V.objectsAmmo[c],d=V.objectsAmmo[u];if(!l||!d)return"continue";var m=l.body.breakable,_=d.body.breakable,A=l.body.collided,P=d.body.collided,O=null===(e=l.body)||void 0===e?void 0:e.checkCollisions,M=null===(n=d.body)||void 0===n?void 0:n.checkCollisions;if(O||M){var C=[l.name,d.name].sort(),T=C[0]+"__"+C[1],E=void 0;E=V.earlierDetectedCollisions.find((function(t){return t.combinedName===T}))?"colliding":"start",r.push({combinedName:T,collision:!0}),V.emit("collision",{bodies:[l,d],event:E})}if(!m&&!_||A&&P)return"continue";for(var S=!1,j=0,k=0,B=t.getNumContacts();k<B;k++)if((h=t.getContactPoint(k)).getDistance()<0){S=!0,(p=h.getAppliedImpulse())>j&&(j=p,f=h.get_m_positionWorldOnB(),y=h.get_m_normalWorldOnB(),V.impactPoint.set(f.x(),f.y(),f.z()),V.impactNormal.set(y.x(),y.y(),y.z()));break}if(!S)return"continue";if(V.emptyV3.set(0,0,0),l.userData={mass:1,velocity:V.emptyV3,angularVelocity:V.emptyV3,breakable:m,physicsBody:i},d.userData={mass:1,velocity:V.emptyV3,angularVelocity:V.emptyV3,breakable:_,physicsBody:a},void 0===l.fragmentDepth&&(l.fragmentDepth=0),void 0===d.fragmentDepth&&(d.fragmentDepth=0),m&&!A&&j>5&&l.fragmentDepth<2){v=V.convexBreaker.subdivideByImpact(l,V.impactPoint,V.impactNormal,1,2),b=v.length;for(k=0;k<b;k++)g=i.getLinearVelocity(),w=i.getAngularVelocity(),(x=v[k]).userData.velocity.set(g.x(),g.y(),g.z()),x.userData.angularVelocity.set(w.x(),w.y(),w.z()),V.createDebrisFromBreakableObject(x,l);V.objectsToRemove[V.numObjectsToRemove++]=l,l.body.collided=!0}if(_&&!P&&j>5&&d.fragmentDepth<2){v=V.convexBreaker.subdivideByImpact(d,V.impactPoint,V.impactNormal,1,2),b=v.length;for(k=0;k<b;k++)g=a.getLinearVelocity(),w=a.getAngularVelocity(),(x=v[k]).userData.velocity.set(g.x(),g.y(),g.z()),x.userData.angularVelocity.set(w.x(),w.y(),w.z()),V.createDebrisFromBreakableObject(x,d);V.objectsToRemove[V.numObjectsToRemove++]=d,d.body.collided=!0}},V=this;for(s=0,a=this.dispatcher.getNumManifolds();s<a;s++)_();for(s=0;s<this.numObjectsToRemove;s++)this.removeDebris(this.objectsToRemove[s]);this.numObjectsToRemove=0,this.earlierDetectedCollisions.forEach((function(t){var e=t.combinedName;if(!r.find((function(t){return t.combinedName===e}))){var n=e.split("__"),i=o.rigidBodies.find((function(t){return t.name===n[0]})),s=o.rigidBodies.find((function(t){return t.name===n[1]}));i&&s&&o.emit("collision",{bodies:[i,s],event:"end"})}})),this.earlierDetectedCollisions=A(r)},e}(c.a),P=n(3);
/**
 * @author       Kevin Lee (https://github.com/InfiniteLee)
 * @copyright    Copyright (c) 2019 Kevin Lee; Project Url: https://github.com/InfiniteLee/three-to-ammo
 * @license      {@link https://github.com/InfiniteLee/three-to-ammo/blob/master/LICENSE|MPL-2.0}
 */
const O="box",M="cylinder",C="sphere",T="capsule",E="cone",S="hull",j="hacd",k="vhacd",B="mesh",D="heightfield",L="all",z="manual",I=n.n(P).a.prototype.hasOwnProperty("updateMatrices"),H=function(t,e){switch(e.type){case O:return R(t,e);case M:return F(t,e);case T:return G(t,e);case E:return N(t,e);case C:return W(t,e);case S:return U(t,e);case j:return Q(t,e);case k:return q(t,e);case B:return Y(t,e);case D:return X(t,e);default:return s()(e.type+" is not currently supported"),[]}},R=function(t,e){e.type=O,Z(e),e.fit===L&&(e.halfExtents=et(t,nt(t,e),e.minHalfExtent,e.maxHalfExtent));const n=new Ammo.btVector3(e.halfExtents.x,e.halfExtents.y,e.halfExtents.z),o=new Ammo.btBoxShape(n);return Ammo.destroy(n),$(o,e,J(t,e)),o},F=function(t,e){e.type=M,Z(e),e.fit===L&&(e.halfExtents=et(t,nt(t,e),e.minHalfExtent,e.maxHalfExtent));const n=new Ammo.btVector3(e.halfExtents.x,e.halfExtents.y,e.halfExtents.z),o=(()=>{switch(e.cylinderAxis){case"y":return new Ammo.btCylinderShape(n);case"x":return new Ammo.btCylinderShapeX(n);case"z":return new Ammo.btCylinderShapeZ(n)}return null})();return Ammo.destroy(n),$(o,e,J(t,e)),o},G=function(t,e){e.type=T,Z(e),e.fit===L&&(e.halfExtents=et(t,nt(t,e),e.minHalfExtent,e.maxHalfExtent));const{x:n,y:o,z:r}=e.halfExtents,i=(()=>{switch(e.cylinderAxis){case"y":return new Ammo.btCapsuleShape(Math.max(n,r),2*o);case"x":return new Ammo.btCapsuleShapeX(Math.max(o,r),2*n);case"z":return new Ammo.btCapsuleShapeZ(Math.max(n,o),2*r)}return null})();return $(i,e,J(t,e)),i},N=function(t,e){e.type=E,Z(e),e.fit===L&&(e.halfExtents=et(t,nt(t,e),e.minHalfExtent,e.maxHalfExtent));const{x:n,y:o,z:r}=e.halfExtents,i=(()=>{switch(e.cylinderAxis){case"y":return new Ammo.btConeShape(Math.max(n,r),2*o);case"x":return new Ammo.btConeShapeX(Math.max(o,r),2*n);case"z":return new Ammo.btConeShapeZ(Math.max(n,o),2*r)}return null})();return $(i,e,J(t,e)),i},W=function(t,e){let n;e.type=C,Z(e),n=e.fit!==z||isNaN(e.sphereRadius)?tt(t,e,nt(t,e)):e.sphereRadius;const o=new Ammo.btSphereShape(n);return $(o,e,J(t,e)),o},U=function(){const t=new u.Vector3,e=new u.Vector3;return function(n,o){if(o.type=S,Z(o),o.fit===z)return console.warn("cannot use fit: manual with type: hull"),null;const r=nt(n,o),i=new Ammo.btVector3,s=new Ammo.btConvexHullShape;s.setMargin(o.margin),e.addVectors(r.max,r.min).multiplyScalar(.5);let a=0;K(n,o,t=>{a+=t.attributes.position.array.length/3});const c=o.hullMaxVertices||1e5;a>c&&console.warn(`too many vertices for hull shape; sampling ~${c} from ~${a} vertices`);const u=Math.min(1,c/a);K(n,o,(n,o)=>{ot(n,o);const r=n.attributes.position.array;for(let n=0;n<r.length;n+=3)Math.random()<=u&&(t.set(r[n],r[n+1],r[n+2]).applyMatrix4(o).sub(e),i.setValue(t.x,t.y,t.z),s.addPoint(i,n===r.length-3))});let l=s;if(s.getNumVertices()>=100){const t=new Ammo.btShapeHull(s);t.buildHull(o.margin),Ammo.destroy(s),l=new Ammo.btConvexHullShape(Ammo.getPointer(t.getVertexPointer()),t.numVertices()),Ammo.destroy(t)}return Ammo.destroy(i),$(l,o,J(n,o)),l}}(),Q=function(){const t=new u.Vector3,e=new u.Vector3;return function(n,o){if(o.type=j,Z(o),o.fit===z)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=nt(n),i=J(n,o);let s=0,a=0;e.addVectors(r.max,r.min).multiplyScalar(.5),K(n,o,t=>{s+=t.attributes.position.array.length/3,t.index?a+=t.index.array.length/3:a+=t.attributes.position.array.length/9});const c=new Ammo.HACD;o.hasOwnProperty("compacityWeight")&&c.SetCompacityWeight(o.compacityWeight),o.hasOwnProperty("volumeWeight")&&c.SetVolumeWeight(o.volumeWeight),o.hasOwnProperty("nClusters")&&c.SetNClusters(o.nClusters),o.hasOwnProperty("nVerticesPerCH")&&c.SetNVerticesPerCH(o.nVerticesPerCH),o.hasOwnProperty("concavity")&&c.SetConcavity(o.concavity);const u=Ammo._malloc(3*s*8),l=Ammo._malloc(3*a*4);c.SetPoints(u),c.SetTriangles(l),c.SetNPoints(s),c.SetNTriangles(a);const d=u/8,m=l/4;K(n,o,(n,o)=>{ot(n,o);const r=n.attributes.position.array,i=n.index?n.index.array:null;for(let n=0;n<r.length;n+=3)t.set(r[n+0],r[n+1],r[n+2]).applyMatrix4(o).sub(e),Ammo.HEAPF64[d+n+0]=t.x,Ammo.HEAPF64[d+n+1]=t.y,Ammo.HEAPF64[d+n+2]=t.z;if(i)for(let t=0;t<i.length;t++)Ammo.HEAP32[m+t]=i[t];else for(let t=0;t<r.length/3;t++)Ammo.HEAP32[m+t]=t}),c.Compute(),Ammo._free(u),Ammo._free(l);const h=c.GetNClusters(),p=[];for(let t=0;t<h;t++){const e=new Ammo.btConvexHullShape;e.setMargin(o.margin);const n=c.GetNPointsCH(t),r=c.GetNTrianglesCH(t),s=Ammo._malloc(3*n*8),a=Ammo._malloc(3*r*4);c.GetCH(t,s,a);const u=s/8;for(let t=0;t<n;t++){const o=new Ammo.btVector3,r=Ammo.HEAPF64[u+3*t+0],i=Ammo.HEAPF64[u+3*t+1],s=Ammo.HEAPF64[u+3*t+2];o.setValue(r,i,s),e.addPoint(o,t===n-1),Ammo.destroy(o)}$(e,o,i),p.push(e)}return p}}(),q=function(){const t=new u.Vector3,e=new u.Vector3;return function(n,o){if(o.type=k,Z(o),o.fit===z)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=nt(n,o),i=J(n,o);let s=0,a=0;e.addVectors(r.max,r.min).multiplyScalar(.5),K(n,o,t=>{s+=t.attributes.position.count,t.index?a+=t.index.count/3:a+=t.attributes.position.count/3});const c=new Ammo.VHACD,u=new Ammo.Parameters;o.hasOwnProperty("resolution")&&u.set_m_resolution(o.resolution),o.hasOwnProperty("depth")&&u.set_m_depth(o.depth),o.hasOwnProperty("concavity")&&u.set_m_concavity(o.concavity),o.hasOwnProperty("planeDownsampling")&&u.set_m_planeDownsampling(o.planeDownsampling),o.hasOwnProperty("convexhullDownsampling")&&u.set_m_convexhullDownsampling(o.convexhullDownsampling),o.hasOwnProperty("alpha")&&u.set_m_alpha(o.alpha),o.hasOwnProperty("beta")&&u.set_m_beta(o.beta),o.hasOwnProperty("gamma")&&u.set_m_gamma(o.gamma),o.hasOwnProperty("pca")&&u.set_m_pca(o.pca),o.hasOwnProperty("mode")&&u.set_m_mode(o.mode),o.hasOwnProperty("maxNumVerticesPerCH")&&u.set_m_maxNumVerticesPerCH(o.maxNumVerticesPerCH),o.hasOwnProperty("minVolumePerCH")&&u.set_m_minVolumePerCH(o.minVolumePerCH),o.hasOwnProperty("convexhullApproximation")&&u.set_m_convexhullApproximation(o.convexhullApproximation),o.hasOwnProperty("oclAcceleration")&&u.set_m_oclAcceleration(o.oclAcceleration);const l=Ammo._malloc(3*s*8),d=Ammo._malloc(3*a*4);let m=l/8,h=d/4;K(n,o,(n,o)=>{ot(n,o);const r=n.attributes.position.array,i=n.index?n.index.array:null;for(let n=0;n<r.length;n+=3)t.set(r[n+0],r[n+1],r[n+2]).applyMatrix4(o).sub(e),Ammo.HEAPF64[m+0]=t.x,Ammo.HEAPF64[m+1]=t.y,Ammo.HEAPF64[m+2]=t.z,m+=3;if(i)for(let t=0;t<i.length;t++)Ammo.HEAP32[h]=i[t],h++;else for(let t=0;t<r.length/3;t++)Ammo.HEAP32[h]=t,h++}),c.Compute(l,3,s,d,3,a,u),Ammo._free(l),Ammo._free(d);const p=c.GetNConvexHulls(),f=[],y=new Ammo.ConvexHull;for(let t=0;t<p;t++){c.GetConvexHull(t,y);const e=y.get_m_nPoints(),n=(y.get_m_points(),new Ammo.btConvexHullShape);n.setMargin(o.margin);for(let t=0;t<e;t++){const o=new Ammo.btVector3,r=y.get_m_points(3*t+0),i=y.get_m_points(3*t+1),s=y.get_m_points(3*t+2);o.setValue(r,i,s),n.addPoint(o,t===e-1),Ammo.destroy(o)}$(n,o,i),f.push(n)}return Ammo.destroy(y),Ammo.destroy(c),f}}(),Y=function(){const t=new u.Vector3,e=new u.Vector3,n=new u.Vector3;return function(o,r){if(r.type=B,Z(r),r.fit===z)return console.warn("cannot use fit: manual with type: mesh"),null;const i=J(o,r),s=new Ammo.btVector3,a=new Ammo.btVector3,c=new Ammo.btVector3,u=new Ammo.btTriangleMesh(!0,!1);let l;return K(o,r,(o,r)=>{const i=o.attributes.position.array;if(o.index)for(let l=0;l<o.index.count;l+=3){const d=3*o.index.array[l],m=3*o.index.array[l+1],h=3*o.index.array[l+2];t.set(i[d],i[d+1],i[d+2]).applyMatrix4(r),e.set(i[m],i[m+1],i[m+2]).applyMatrix4(r),n.set(i[h],i[h+1],i[h+2]).applyMatrix4(r),s.setValue(t.x,t.y,t.z),a.setValue(e.x,e.y,e.z),c.setValue(n.x,n.y,n.z),u.addTriangle(s,a,c,!1)}else for(let o=0;o<i.length;o+=9)t.set(i[o+0],i[o+1],i[o+2]).applyMatrix4(r),e.set(i[o+3],i[o+4],i[o+5]).applyMatrix4(r),n.set(i[o+6],i[o+7],i[o+8]).applyMatrix4(r),s.setValue(t.x,t.y,t.z),a.setValue(e.x,e.y,e.z),c.setValue(n.x,n.y,n.z),u.addTriangle(s,a,c,!1)}),l=r.concave?new Ammo.btBvhTriangleMeshShape(u,!0,!0):new Ammo.btConvexTriangleMeshShape(u,!0),l.resources=[u],Ammo.destroy(s),Ammo.destroy(a),Ammo.destroy(c),$(l,r,i),l}}(),X=function(t,e){if(Z(e),e.fit===L)return console.warn("cannot use fit: all with type: heightfield"),null;const n=e.heightfieldDistance||1,o=e.heightfieldData||[],r=e.heightScale||0,i=e.hasOwnProperty("upAxis")?e.upAxis:1,s=(()=>{switch(e.heightDataType){case"short":return Ammo.PHY_SHORT;case"float":default:return Ammo.PHY_FLOAT}})(),a=!e.hasOwnProperty("flipQuadEdges")||e.flipQuadEdges,c=o.length,u=c>0?o[0].length:0,l=Ammo._malloc(c*u*4),d=l/4;let m=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,p=0;for(let t=0;t<c;t++)for(let e=0;e<u;e++){const n=o[t][e];Ammo.HEAPF32[d+p]=n,p++,m=Math.min(m,n),h=Math.max(h,n)}const f=new Ammo.btHeightfieldTerrainShape(u,c,l,r,m,h,i,s,a),y=new Ammo.btVector3(n,1,n);return f.setLocalScaling(y),Ammo.destroy(y),f.heightfieldData=l,$(f,e),f};function Z(t){t.fit=t.hasOwnProperty("fit")?t.fit:L,t.type=t.type||S,t.minHalfExtent=t.hasOwnProperty("minHalfExtent")?t.minHalfExtent:0,t.maxHalfExtent=t.hasOwnProperty("maxHalfExtent")?t.maxHalfExtent:Number.POSITIVE_INFINITY,t.cylinderAxis=t.cylinderAxis||"y",t.margin=t.hasOwnProperty("margin")?t.margin:.05,t.includeInvisible=!!t.hasOwnProperty("includeInvisible")&&t.includeInvisible,t.offset||(t.offset=new u.Vector3),t.orientation||(t.orientation=new u.Quaternion)}const $=function(t,e,n){if(t.type=e.type,t.setMargin(e.margin),t.destroy=()=>{for(let e of t.resources||[])Ammo.destroy(e);t.heightfieldData&&Ammo._free(t.heightfieldData),Ammo.destroy(t)},n){const e=new Ammo.btVector3(n.x,n.y,n.z);t.setLocalScaling(e),Ammo.destroy(e)}},K=function(){const t=new u.Matrix4,e=new u.Matrix4,n=new u.BufferGeometry;return function(o,r,i){e.getInverse(o.matrixWorld),o.traverse(r=>{r.isMesh&&(r===o?t.identity():(I&&r.updateMatrices(),t.multiplyMatrices(e,r.matrixWorld)),i(r.geometry.isBufferGeometry?r.geometry:n.fromGeometry(r.geometry),t))})}}(),J=function(t,e){const{scale:n}=t;return n},tt=function(){const t=new u.Vector3,e=new u.Vector3;return function(n,o,r){let i=0,{x:s,y:a,z:c}=r.getCenter(e);return K(n,o,(e,n)=>{const o=e.attributes.position.array;for(let e=0;e<o.length;e+=3){t.set(o[e],o[e+1],o[e+2]).applyMatrix4(n);const r=s-t.x,u=a-t.y,l=c-t.z;i=Math.max(i,r*r+u*u+l*l)}}),Math.sqrt(i)}}(),et=function(t,e,n,o){return(new u.Vector3).subVectors(e.max,e.min).multiplyScalar(.5).clampScalar(n,o)},nt=function(){const t=new u.Vector3;return function(e,n){const o=new u.Box3;let r=1/0,i=1/0,s=1/0,a=-1/0,c=-1/0,l=-1/0;return o.min.set(0,0,0),o.max.set(0,0,0),K(e,n,(e,n)=>{const o=e.attributes.position.array;for(let e=0;e<o.length;e+=3)t.set(o[e],o[e+1],o[e+2]).applyMatrix4(n),t.x<r&&(r=t.x),t.y<i&&(i=t.y),t.z<s&&(s=t.z),t.x>a&&(a=t.x),t.y>c&&(c=t.y),t.z>l&&(l=t.z)}),o.min.set(r,i,s),o.max.set(a,c,l),o}}(),ot=(t,e)=>{t.computeBoundingBox();const n=new u.Vector3;t.boundingBox.getCenter(n),e.makeTranslation(n.x,n.y,n.z)};
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */
var rt=n(11),it=n.n(rt),st=n(6),at=n(4),ct=n.n(at),ut=n(7),lt=function(){function t(t){void 0===t&&(t=!0),this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return t.prototype.start=function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.prototype.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.prototype.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.prototype.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t},t}(),dt=n(8),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ht=function(){return(ht=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},pt=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o},ft=function(t){function e(e,n){void 0===n&&(n={});var o=t.call(this)||this;if(o.scene=e,o.config=n,o.rigidBodies=[],o.objectsAmmo={},o.earlierDetectedCollisions=[],o.isHeadless="headless"===e,o.tmpEuler=new u.Euler,o.tmpQuaternion=new u.Quaternion,o.tmpVector3=new u.Vector3,o.tmpBtVector3=new Ammo.btVector3,o.tmpBtQuaternion=new Ammo.btQuaternion(0,0,0,1),"headless"!==e){o.defaultMaterial=new ct.a;var r="three.js version "+u.REVISION;console.log("%c %c %c %c %c "+r+" %c https://threejs.org/","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}return o.factory=new it.a(e),o.emptyV3=new u.Vector3,o.impactPoint=new u.Vector3,o.impactNormal=new u.Vector3,o.gravity=n.gravity||{x:0,y:-9.81,z:0},o.start(),o}return mt(e,t),Object.defineProperty(e.prototype,"debug",{get:function(){var t=this;return this.isHeadless?null:{enable:function(){t.debugDrawer.enable()},mode:function(e){void 0===e&&(e=1),t.debugDrawer.setDebugMode(e)},disable:function(){t.debugDrawer.disable()}}},enumerable:!0,configurable:!0}),e.prototype.start=function(){var t=this;"undefined"!=typeof Ammo?"function"==typeof Ammo?Ammo().then((function(){t.setup()})):this.setup():s()("Are you sure you included ammo.js?")},Object.defineProperty(e.prototype,"add",{get:function(){var t=this;return{collider:function(e,n,o){return t.addCollider(e,n,o)},constraints:this.addConstraints,existing:function(e,n){return t.addExisting(e,n)},plane:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addPlane(e,n)},sphere:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addSphere(e,n)},ground:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addGround(e,n)},box:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addBox(e,n)},cylinder:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addCylinder(e,n)},cone:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addCone(e,n)},torus:function(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.addTorus(e,n)},extrude:function(e,n){return void 0===n&&(n={}),t.addExtrude(e,n)}}},enumerable:!0,configurable:!0}),e.prototype.addCompoundShape=function(t){var e=new Ammo.btCompoundShape;return t.forEach((function(n,o){var r,i=new Ammo.btTransform,s=new u.Vector3(n.x||0,n.y||0,n.z||0);if(null===(r=n.tmp)||void 0===r?void 0:r.offset){var a=n.tmp.offset;s.add(new u.Vector3(a.x,a.y,a.z))}i.setIdentity(),i.setOrigin(new Ammo.btVector3(s.x||0,s.y||0,s.z||0)),e.addChildShape(i,t[o])})),e},e.prototype.addExisting=function(t,e){var n,o,r,i=this;void 0===e&&(e={});var a=t.position,c=t.quaternion,u=t.hasBody,l=e.mass,d=void 0===l?1:l,m=e.autoCenter,h=void 0!==m&&m,p=e.offset,f=void 0===p?void 0:p,y=e.shapes,v=void 0===y?[]:y,b=e.breakable,g=void 0!==b&&b,w=e.addRigidBody,x=void 0===w||w,_=e.addChildren,A={width:1,height:1,depth:1,radius:1,radiusTop:1,radiusBottom:1,tube:.4,tubularSegments:6},V=[];(void 0===_||_)&&t.children.length>=1&&t.children.forEach((function(t){if(t.isMesh){var e=i.addExisting(t,{addRigidBody:!1});e.tmp={offset:t.position.clone()},V.push(e)}}));var P="box",O=(null===(n=t.geometry)||void 0===n?void 0:n.type)||"box";/box/i.test(O)?P="box":/cone/i.test(O)?P="cone":/cylinder/i.test(O)?P="cylinder":/extrude/i.test(O)?P="extrude":/plane/i.test(O)?P="plane":/sphere/i.test(O)?P="sphere":/torus/i.test(O)&&(P="torus");var M={};if(e.shape?(M=ht(ht({},A),e),P=e.shape):t.shape?(M=ht(ht({},A),null===(o=null==t?void 0:t.geometry)||void 0===o?void 0:o.parameters),P=t.shape):M=ht(ht({},A),null===(r=null==t?void 0:t.geometry)||void 0===r?void 0:r.parameters),Object.keys(M).forEach((function(t){void 0===M[t]&&A[t]&&(M[t]=A[t])})),u)s()('Object "'+t.name+'" already has a physical body!');else{var C;if(h&&t.geometry.center(),"extrude"===P&&(P="hacd"),"mesh"!==P&&"convex"!==P||(P="convexMesh"),"concave"===P&&(P="concaveMesh"),v.length>0){var T=[];v.forEach((function(t){var e=i.addShape({shape:t.shape,params:ht({},t)});e.tmp={offset:{x:t.x||0,y:t.y||0,z:t.z||0}},T.push(e)})),C=this.addCompoundShape(T)}else C=this.addShape({shape:P,shapes:v,params:M,object:t,quat:c});if(C){if(V.length>=1&&(C=this.addCompoundShape(pt([C],V))),C.setMargin(.05),!x)return C;this.addRigidBodyToShape(t,C,{mass:d,pos:a,quat:c,breakable:g,offset:f,config:e})}else s()('Could not recognize shape "'+P+'"!')}},e.prototype.addRigidBodyToShape=function(t,e,n){var o=n.mass,r=void 0===o?1:o,i=n.pos,s=void 0===i?new u.Vector3(0,0,0):i,a=n.quat,c=void 0===a?new u.Quaternion(0,0,0,1):a,l=n.breakable,d=void 0!==l&&l,m=n.offset,h=void 0===m?{x:0,y:0,z:0}:m,p=n.config,f=void 0===p?{}:p;this.addRigidBody(t,e,r,s,c),this.addBodyProperties(t,f),d&&(t.body.breakable=!0),h&&(t.body.offset=ht({x:0,y:0,z:0},h))},e.prototype.addShape=function(t){var e,n=t.shape,o=t.object,r=t.params,i=t.quat;switch(n){case"plane":e=H(o,{type:"mesh",concave:!1});break;case"box":e=new Ammo.btBoxShape(new Ammo.btVector3(r.width/2,r.height/2,r.depth/2));break;case"sphere":e=new Ammo.btSphereShape(r.radius);break;case"cylinder":e=new Ammo.btCylinderShape(new Ammo.btVector3(r.radiusTop,r.height/2,0));break;case"cone":e=new Ammo.btConeShape(r.radius,r.height);break;case"torus":e=function(t,e){var n=t.radius,o=void 0===n?1:n,r=t.tube,i=void 0===r?.4:r,s=t.tubularSegments,a=void 0===s?8:s,c=Math.PI,u=a,l=Math.sqrt(2*i*i-2*i*i*Math.cos(2*c/u)),d=new Ammo.btVector3(i,c/u+.5*l,i),m=new Ammo.btCylinderShape(d);m.setMargin(.05);for(var h=new Ammo.btCompoundShape,p=new Ammo.btVector3(0,0,1),f=new Ammo.btVector3(0,o,0),y=new Ammo.btQuaternion(e.x,e.y,e.z,e.w),v=0;v<u;v++){var b=2*v*c/u,g=f.rotate(p,b),w=new Ammo.btTransform;y.setRotation(p,b+Math.PI/2),w.setIdentity(),w.setOrigin(g),w.setRotation(y),h.addChildShape(w,m)}return h}(r,i);break;case"capsule":e=new Ammo.btCapsuleShape(r.radius,r.height);break;case"hull":e=H(o,{type:"hull"});break;case"hacd":e=H(o,{type:"hacd"});break;case"vhacd":e=H(o,{type:"vhacd"});break;case"convexMesh":e=H(o,{type:"mesh",concave:!1});break;case"concaveMesh":e=H(o,{type:"mesh",concave:!0})}if(Array.isArray(e)){var s=new Ammo.btCompoundShape;e.forEach((function(t){var e=new Ammo.btTransform;e.setIdentity(),s.addChildShape(e,t)})),e=s}return e},e.prototype.createRigidBody=function(t,e,n,o){var r=new Ammo.btTransform;r.setIdentity(),r.setOrigin(new Ammo.btVector3(n.x,n.y,n.z)),r.setRotation(new Ammo.btQuaternion(o.x,o.y,o.z,o.w));var i=new Ammo.btDefaultMotionState(r),s=new Ammo.btVector3(0,0,0);e>0&&t.calculateLocalInertia(e,s);var a=new Ammo.btRigidBodyConstructionInfo(e,i,t,s);return new Ammo.btRigidBody(a)},e.prototype.addRigidBody=function(t,e,n,o,r,i){t.position.copy(o),t.quaternion.copy(r);var s=this.createRigidBody(e,n,o,r);if(i){var a=new Ammo.btVector3(i.x,i.y,i.z);e.setLocalScaling(a),Ammo.destroy(a)}n>0&&s.setActivationState(4),this.rigidBodies.push(t),this.physicsWorld.addRigidBody(s);var c=Object.values(s)[0];s.name=t.name,t.body=new l(this,s),t.hasBody=!0,t.ptr=c,this.objectsAmmo[c]=t},e.prototype.addBodyProperties=function(t,e){var n=e.friction,o=void 0===n?.5:n,r=e.collisionFlags,i=void 0===r?0:r;t.body.setCollisionFlags(i),t.body.setFriction(o)},e}(c.a);m()(ft,[V,f,p,v]),n.d(e,"PhysicsLoader",(function(){return st.PhysicsLoader})),n.d(e,"Types",(function(){return ut})),n.d(e,"Clock",(function(){return lt})),n.d(e,"ServerClock",(function(){return dt.ServerClock})),n.d(e,"AmmoPhysics",(function(){return ft}))}])}));
//# sourceMappingURL=enable3d.ammoPhysics.0.0.16.min.js.map